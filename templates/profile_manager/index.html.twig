{% extends 'base.html.twig' %}
{% set photoBase64 = user.photo|to_base64 %}
{% block title %}Profil -
	{{user.username}}
{% endblock %}

{% block body %}
	<div class="oxanium my-5 ecoride-container p-lg-5 justify-content-center rounded">
		<h1 class="my-3 text-center viga-regular">Mon profil :
		</h1>

		<table class="table justify-content-center d-inline-flex">
			<tbody class="rounded shadow-sm">
				<tr>
					<th class="col align-middle">
						<span>Photo de profil :</span>
					</th>
					<td class="col-auto align-middle">

						<div class="row row-cols-2 my-2 align-items-center">
							<div class="col-lg-2">
								{% if photoBase64 is not null %}
									<img src="data:image/webp;base64,{{ photoBase64|e }}" class="profile-img" alt="Image de profil">
								{% else %}
									<img src="{{ asset('import/blank-profile.png') }}" alt="Image par défaut" class="profile-img">
								{% endif %}
							</div>
							<div class="col-lg-10">
								{{ form_start(form) }}
								<div class="d-flex justify-content-evenly">
									<div>
										{{ form_row(form.photo) }}
									</div>
									<div>
										<button type="submit" class="load-btn btn btn-success mb-3">
											<span class="spinner-border spinner-border-sm ms-2 d-none" role="status" aria-hidden="true" data-loading-text="Ajout..."></span>
											<span class="btn-text">{{photoBase64 == null ? "Ajouter une" : "Modifier la"}}
												photo</span>
										</button>
										<form action="{{ path(name = 'app_delete_profile_picture', parameters = {user_id: user.id} ) }}" class="load-btn btn btn-danger {{photoBase64 == null ? " disabled" : " "}}" method="post">
											<input type="hidden" name="_method" value="DELETE">
											<button type="submit" role="button" {{photoBase64 == null ? "aria-disabled='true'" : ""}} data-loading-text="Supression...">
												<span class="spinner-border spinner-border-sm ms-2 d-none" role="status" aria-hidden="true"></span>
												<span class="btn-text">Supprimer</span>
											</button>
										</form>
									</div>


								</div>
							</div>
							{{ form_end(form) }}

						</div>
					</td>
				</tr>
			</tbody>
		</table>


		<table class="table justify-content-center rounded d-inline-flex">
			<tbody class="rounded shadow-sm">
				<tr>
					<th class="col-lg-5">Nom d'utilisateur :
					</th>
					<td class="col-auto">
						{{user.username}}
					</td>
				</tr>
				<tr>
					<th class="col">Nom de famille :
					</th>
					<td class="col">
						{{user.firstname}}
					</td>
				</tr>
				<tr>
					<th class="col">Prénom :
					</th>
					<td>
						{{user.lastname}}
					</td>

				</tr>
				<tr>
					<th class="col">Numéro de téléphone :
					</th>
					<td>
						{{user.phonenumber}}
					</td>

				</tr>
				<tr>
					<th class="col">Adresse postale :
					</th>
					<td>
						{{user.postaladress}}
					</td>

				</tr>
				<tr>
					<th class="col">Date de naissance :
					</th>
					<td>
						{{user.birthdate | date('d / m / Y')}}
					</td>

				</tr>
				<tr>
					<th class="col">Type de profil :
					</th>
					<td>
						{% set labels = {
    					'ROLE_PASSAGER': 'Passager',
						'ROLE_DRIVER': 'Chauffeur',
						'ROLE_USER': ''
						} %}

						{% for role in user.roles %}
							{{ labels[role]|default('') }}
						{% endfor %}

					</td>

				</tr>
				<tr>
					<th></th>
					<td>
						<a href="" class="btn btn-primary">Modifier</a>
					</td>
				</tr>
			</tbody>
		</table>
	</div>
{% endblock %}
